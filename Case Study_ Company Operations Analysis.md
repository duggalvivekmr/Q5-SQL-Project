**Case Study: Company Operations Analysis**  
**Scenario**:

XYZ Inc. is an e-commerce company that was launched in 2015\. Since then, they have had a range of operations in multiple districts of the country.

They have a high-functioning team and an excellent reputation among their customers. The firm is quite interested in doing a regular analysis on multiple domains for a perennial health check across all domains. As they have the policy to have multiple analysts review the different aspects of their businesses, They have hired you as a Data Scientist in their data consulting team which offers services across various departments such as sales, customers, HR, etc.   
They have given you a sample of data from their databases (DDL Commands File is shared separately). You have to work with the teams to help them with some of their pain points like pricing analysis, product growth, product sales, etc. as well as help them work on a new set of financial analyses and do target market/product fit analysis.

**Questions:**

1. **List all employees who are managers.**  
2. **Find the total salary expenditure per department.**  
3. **List the employees working on more than one project.**  
4. **Find the projects that have not ended yet.**  
5. **Identify the highest and lowest salaries for each job role.**  
6. **List all employees whose email address contains ‘company’.**  
7. **Find the total number of employees in each department.**  
8. **Calculate the average salary for each department.**  
9. **List the employees who joined the company before 2020\.**  
10. **Display the details of projects handled by IT department employees.**  
11. **Calculate the Top 3 Products by Revenue for Each Customer**  
    1. **Question: Write a query to find the top 3 products that generated the most revenue for each customer. Return the customer\_id, product\_id, and the total\_revenue for these top 3 products. If a customer has fewer than 3 products, return all of them.**  
12. **Identify Customers with No Orders in the Last 6 Months**  
    1. **Question: Write a query to find the customer\_id and customer\_name of customers who have not placed any orders in the last 6 months from the current date.**  
13. **Calculate the Average Order Value by Customer Segment**  
    1. **Question: Write a query to calculate the average order value for each customer segment. Return the segment\_name and the average\_order\_value.**  
14. **Identify Top Customers by Order Value**  
    1. **Question: Write a query to find the top 3 customers who have spent the most money across all their orders. Consider the total order\_value for each customer and order the result by total spend in descending order.**  
15. **Analyzing Customer Behavior Over Time**  
    1. **Question: Identify customers who have made purchases in at least 3 different years. Return the customer ID and the number of distinct years in which they made purchases.**  
16. **Correlate Product Categories with Order Volume**  
    1. **Question: Write a query to find the product category that has the highest average order volume (quantity). Return the category name and the average quantity ordered.**  
17. **Finding Frequent Customers and Their Orders**  
    1. **Question: Identify customers who have placed more than 5 orders in any single month. Return the customer ID, the month, and the number of orders they placed in that month.**  
18. **Track Customer Retention Rates**  
    1. **Question: Calculate the retention rate of customers by identifying how many customers who made a purchase in the first quarter of any year also made a purchase in the second quarter of the same year. Return the year, the number of customers in Q1, the number of retained customers in Q2, and the retention rate.**  
19. **Identify Unusual Customer Behavior**  
    1. **Question: Identify customers who have had a month with a number of orders that is more than double the average number of orders they typically place in a month. Return the customer ID, the month in which this anomaly occurred, and the number of orders placed in that month.**  
20. **Product Cross-Sell Analysis**  
    1. **Question: Identify pairs of products that are frequently bought together in the same order. For each pair, return the two product IDs and the number of orders in which both products were bought together. Only return pairs that appear in at least 3 different orders.**  
21. **Inventory Turnover Rate**  
    1. **Question: Calculate the inventory turnover rate for each product. The inventory turnover rate is defined as the total quantity sold divided by the average quantity available in inventory during the period. Assume you have a table `Inventory` with `product_id`, `quantity_available`, and `inventory_date`. Return the product ID and the turnover rate, sorted by the highest turnover rate.**  
22. **Identify Most Consistent Products**  
    1. **Question: Identify products that have the most consistent monthly sales volume, measured by the standard deviation of the number of orders across months. Return the product ID and the standard deviation of the number of orders, sorted by the lowest standard deviation.**

